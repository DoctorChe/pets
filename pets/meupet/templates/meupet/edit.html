{% extends '_layouts/base.html' %}
{% load crispy_forms_tags %}
{% load thumbnail %}

{% block content %}
  <form class="form-horizontal col-md-6" method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="form-group">
      <label for="name" class="col-sm-2 control-label">Nome</label>

      <div class="col-sm-10">
        <input type="text" class="form-control" id="name" name="name" placeholder="Nome"
               value="{{ form.name.value }}">
        {{ form.errors.name }}
      </div>
    </div>

    <div class="form-group">
      <label for="description" class="col-sm-2 control-label">Descrição</label>

      <div class="col-sm-10">
        <textarea class="form-control" rows="5" id="description" name="description"
                  placeholder="Descrição">{{ form.description.value }}</textarea>
        {{ form.errors.description }}
      </div>
    </div>

    <div class="form-group">
      <label for="city" class="col-sm-2 control-label">Cidade</label>

      <div class="col-sm-10">
        <input type="text" class="form-control" id="city" name="city" placeholder="Cidade"
               value="{{ form.city.value }}">
        {{ form.errors.city }}
      </div>
    </div>

    <div class="form-group">
      <label for="kind" class="col-sm-2 control-label">Espécie</label>

      <div class="col-sm-10">
        <select id="kind" class="form-control" name="kind">
          {% for choice in form.fields.kind.choices.queryset %}
            <option value="{{ choice.id }}"
                {% if choice.id == form.kind.value %}
                    selected="selected"
                {% endif %}
                >{{ choice }}</option>
          {% endfor %}
        </select>
        {{ form.errors.kind }}
      </div>
    </div>

    <div class="form-group">
      <label for="size" class="col-sm-2 control-label">Tamanho</label>

      <div class="col-sm-10">
        <select id="size" class="form-control" name="size">
          {% for value, text in form.fields.size.choices %}
            <option value="{{ value }}"
                {% if value == form.size.value %}
                    selected="selected"
                {% endif %}
                >{{ text }}</option>
          {% endfor %}
        </select>
        {{ form.errors.size }}
      </div>
    </div>

    <div class="form-group">
      <label for="profile_picture" class="col-sm-2 control-label">Foto</label>

      <div class="col-sm-10">
        <input type="file" id="profile_picture" name="profile_picture">
        {{ form.errors.profile_picture }}
      </div>
    </div>

    <div class="form-group">
      <input type="submit" name="submit" class="btn btn-primary pull-right"
             value="Gravar Alterações">
    </div>
  </form>

  <div class="col-md-6">
    <img id="picture" class="img-thumbnail"
         src="{{ form.instance.profile_picture|thumbnail_url:'pet_thumb' }}"
         alt="{{ pet }}"/>
  </div>
{% endblock %}

{% block morescripts %}
  <script>
    $(document).ready(function () {
      $('#profile_picture').on('change', function () {
        var reader = new FileReader();
        reader.onload = function (e) {
          $('#picture').attr('src', e.target.result);
        };
        reader.readAsDataURL(this.files[0]);
      });
    });
  </script>
{% endblock %}
